{
  "_meta": {
    "config_version": "2.1_developer_optimized",
    "customer": "JF",
    "created": "2025-10-31",
    "description": "Developer-friendly config with DRY principles and inheritance"
  },

  "data_preparation_module_hint": {
    "prority": ["po"],
    "numbers_per_group_by_po": 7
  },

  "template_store": {

  },
  
  "features": {
    "_comment": "Feature flags for optional/experimental functionality",
    "enable_text_replacement": false,
    "enable_conditional_formatting": false,
    "enable_data_validation": false,
    "enable_auto_calculations": true,
    "enable_print_area": false,
    "enable_page_breaks": false,
    "debug_mode": false
  },
  
  "extensions": {
    "_comment": "Custom extensions - add new features here without breaking existing config",
    "_available_hooks": ["pre_build", "post_build", "pre_style", "post_style"],
    "custom": {}
  },
  
  "processing": {
    "sheets": ["Invoice", "Contract", "Packing list"],
    "data_sources": {
      "Invoice": "aggregation",
      "Contract": "aggregation",
      "Packing list": "processed_tables_multi"
    }
  },
  
  "styling_bundle": {
    "_comment": "Centralized styling - all styles explicit per sheet (no inheritance due to inconsistent styling across invoices)",
    
    "defaults": {
      "borders": {
        "_comment": "Border configuration - same for all sheets",
        "default_border": "full_grid",
        "default_style": "thin",
        "exceptions": {
          "col_static": "side_only"
        }
      }
    },
    
    "Invoice": {
      "header": {
        "font": {"bold": true, "size": 12, "name": "Calibri"},
        "alignment": {"horizontal": "center", "vertical": "center", "wrap_text": true},
        "row_height": 35
      },
      "data": {
        "font": {"size": 12, "name": "Calibri"},
        "alignment": {"horizontal": "center", "vertical": "center", "wrap_text": true},
        "row_height": 35
      },
      "footer": {
        "font": {"bold": true, "size": 12, "name": "Calibri"},
        "alignment": {"horizontal": "center", "vertical": "center"},
        "row_height": 35
      },
      "dimensions": {
        "_comment": "Column widths - only specify to override template defaults",
        "column_widths": {
          "col_po": 28,
          "col_desc": 20
        }
      },
      "column_specific": {
        "col_static": {
          "alignment": {"horizontal": "center", "vertical": "center"}
        },
        "col_desc": {
          "alignment": {"horizontal": "center", "vertical": "center"}
        }
      }
    },
    
    "Contract": {
      "header": {
        "font": {"bold": true, "size": 16, "name": "Calibri"},
        "alignment": {"horizontal": "center", "vertical": "center", "wrap_text": true},
        "row_height": 36
      },
      "data": {
        "font": {"size": 14, "name": "Calibri"},
        "alignment": {"horizontal": "center", "vertical": "center", "wrap_text": true},
        "row_height": 30
      },
      "footer": {
        "font": {"bold": true, "size": 16, "name": "Calibri"},
        "alignment": {"horizontal": "center", "vertical": "center"},
        "row_height": 36
      },
      "dimensions": {
        "column_widths": {
          "col_no": 14,
          "col_qty_sf": 27,
          "col_unit_price": 28,
          "col_amount": 47
        }
      },
      "column_specific": {}
    },
    
    "Packing list": {
      "header": {
        "font": {"bold": true, "size": 12, "name": "Calibri"},
        "alignment": {"horizontal": "center", "vertical": "center", "wrap_text": true},
        "row_height": 27
      },
      "data": {
        "font": {"size": 12, "name": "Calibri"},
        "alignment": {"horizontal": "center", "vertical": "center", "wrap_text": true},
        "row_height": 27
      },
      "footer": {
        "font": {"bold": true, "size": 12, "name": "Calibri"},
        "alignment": {"horizontal": "center", "vertical": "center"},
        "row_height": 27
      },
      "before_footer": {
        "row_height": 27
      },
      "dimensions": {
        "column_widths": {
          "col_static": 24.71,
          "col_po": 17,
          "col_item": 22.14,
          "col_desc": 26,
          "col_qty_pcs": 15,
          "col_qty_sf": 15,
          "col_net": 15,
          "col_gross": 15,
          "col_cbm": 15
        }
      },
      "column_specific": {
        "col_static": {
          "alignment": {"horizontal": "left", "vertical": "top"}
        }
      }
    }
  },
  
  "layout_bundle": {
    "_comment": "Layout configuration - structure, data flow, content, and footer rules",
    
    "Invoice": {
      "_sections": ["structure", "data_flow", "content", "footer"],
      
      "structure": {
        "header_row": 21,
        "columns": [
          {"id": "col_static", "header": "Mark & Nº"},
          {"id": "col_po", "header": "P.O. Nº", "format": "@"},
          {"id": "col_item", "header": "ITEM Nº", "format": "@"},
          {"id": "col_desc", "header": "Description"},
          {"id": "col_qty_sf", "header": "Quantity(SF)", "format": "#,##0.00"},
          {"id": "col_unit_price", "header": "Unit price (USD)", "format": "#,##0.00"},
          {"id": "col_amount", "header": "Amount (USD)", "format": "#,##0.00"}
        ]
      },
      
      "data_flow": {
        "mappings": {
          "po": {"column": "col_po", "source_key": 0},
          "item": {"column": "col_item", "source_key": 1},
          "description": {"column": "col_desc", "source_key": 3, "fallback": "LEATHER"},
          "sqft": {"column": "col_qty_sf", "source_value": "sqft_sum"},
          "unit_price": {"column": "col_unit_price", "source_key": 2},
          "amount": {"column": "col_amount", "formula": "{col_qty_sf} * {col_unit_price}"}
        }
      },
      
      "content": {
        "static": {
          "col_static": ["VENDOR#:", "Des: LEATHER", "MADE IN CAMBODIA"],
          "before_footer": {"col": 2, "text": "HS.CODE: 4107.12.00"}
        }
      },
      
      "footer": {
        "total_column": 1,
        "pallet_column": 2,
        "add_ons": {
          "weight_summary": {
            "enabled": false,
            "label_col_id": "col_po",
            "value_col_id": "col_item",
            "mode": ["daf", "standard"]
          },
          "leather_summary": {
            "enabled": false,
            "mode": ["daf", "standard"]
          }
        }
      }
    },
    
    "Contract": {
      "_sections": ["structure", "data_flow", "footer"],
      
      "structure": {
        "header_row": 15,
        "columns": [
          {"id": "col_no", "header": "No.", "format": "@"},
          {"id": "col_item", "header": "ITEM Nº"},
          {"id": "col_qty_sf", "header": "Quantity(SF)", "format": "#,##0.00"},
          {"id": "col_unit_price", "header": "Unit Price(USD)", "format": "#,##0.00"},
          {"id": "col_amount", "header": "Total value(USD)", "format": "#,##0.00"}
        ]
      },
      
      "data_flow": {
        "mappings": {
          "po": {"column": "col_po", "source_key": 0},
          "item": {"column": "col_item", "source_key": 1},
          "desc": {"column": "col_desc", "source_key": 3, "fallback": "LEATHER"},
          "sqft": {"column": "col_qty_sf", "source_value": "sqft_sum"},
          "unit_price": {"column": "col_unit_price", "source_key": 2},
          "amount": {"column": "col_amount", "formula": "{col_qty_sf} * {col_unit_price}"}
        }
      },
      
      "footer": {
        "total_column": 0,
        "merge_cells": {"start": 0, "span": 2},
        "add_ons": {
          "weight_summary": {
            "enabled": false,
            "label_col_id": "col_no",
            "value_col_id": "col_item",
            "mode": ["daf", "standard"]
          },
          "leather_summary": {
            "enabled": false,
            "mode": ["daf", "standard"]
          }
        }
      }
    },
    
    "Packing list": {
      "_sections": ["structure", "data_flow", "content", "footer"],
      
      "structure": {
        "header_row": 21,
        "columns": [
          {"id": "col_static", "header": "Mark & Nº", "rowspan": 2},
          {"id": "col_po", "header": "P.O Nº", "rowspan": 2, "format": "@"},
          {"id": "col_item", "header": "ITEM Nº", "rowspan": 2, "format": "@"},
          {"id": "col_desc", "header": "Description", "rowspan": 2, "format": "@"},
          {"id": "col_qty_header", "header": "Quantity(SF)", "colspan": 2, "children": [
            {"id": "col_qty_pcs", "header": "PCS", "format": "#,##0"},
            {"id": "col_qty_sf", "header": "SF", "format": "#,##0.00"}
          ]},
          {"id": "col_net", "header": "N.W (kgs)", "rowspan": 2, "format": "#,##0.00"},
          {"id": "col_gross", "header": "G.W (kgs)", "rowspan": 2, "format": "#,##0.00"},
          {"id": "col_cbm", "header": "CBM", "rowspan": 2, "format": "0.00"}
        ]
      },
      
      "data_flow": {
        "mappings": {
          "po": {"column": "col_po"},
          "item": {"column": "col_item"},
          "description": {"column": "col_desc", "fallback": "LEATHER"},
          "pcs": {"column": "col_qty_pcs"},
          "sqft": {"column": "col_qty_sf"},
          "net": {"column": "col_net"},
          "gross": {"column": "col_gross"},
          "cbm": {"column": "col_cbm"}
        }
      },
      
      "content": {
        "static": {
          "col_static": ["VENDOR#:", "Des: LEATHER", "Case Qty:", "MADE IN CAMBODIA"],
          "before_footer": {"col": 2, "text": "LEATHER (HS.CODE: 4107.12.00)", "merge": 2}
        }
      },
      
      "footer": {
        "total_column": 1,
        "pallet_column": 2,
        "add_blank_before": true,
        "add_ons": {
          "weight_summary": {
            "enabled": false,
            "label_col_id": "col_po",
            "value_col_id": "col_item",
            "mode": ["daf", "standard"]
          },
          "leather_summary": {
            "enabled": false,
            "mode": ["daf", "standard"]
          }

        }
      }
    }
  },
  
  "defaults": {
    "footer": {
      "show_total": true,
      "show_pallet_count": true,
      "total_text": "TOTAL:",
      "merge_total_cells": true,
      "sum_columns": ["col_qty_pcs", "col_qty_sf", "col_net", "col_gross", "col_cbm"]
    }
  }
}

